---
title: "WM_selection"
author: "Nieto_Lopez"
date: "8/29/2018"
output:
  html_document: default
  pdf_document: default
---
```{r setup, include=FALSE}
#Image: ![](Documents/to/white_mold.png)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(knitr)
library(maps)
library(mapdata)
library(geosphere)
library(sf)
library(lwgeom)
library(knitr)
library(kableExtra)
library(tinytex)
library(arsenal)
library(magrittr)
knitr::opts_chunk$set(echo = TRUE)
# graph names of the body means "number isolates/field" 
# graph names of powdery mildews means "Year"

```
###Reading data 
```{r}
###
WM <- read.csv("data/WM-fixingproductnamesID2573_modifyingforactiveingredient_2.csv", stringsAsFactors = TRUE)# Making the columns as 
WM$Collection_ID <- str_squish(WM$Collection_ID)# reading with the symbols that this column has
#factors
#filtering  because in blank on with question mark in the inventory
WM <-  WM %>% 
   filter(!Collection_ID== "429", !Collection_ID== "433", !Collection_ID== "442", !Collection_ID== "1048", !Collection_ID== "1049", !Collection_ID== "2217", !Collection_ID== "2219", !Collection_ID== "2226", !Collection_ID== "2245", !Collection_ID== "2307", !Collection_ID== "2327", !Collection_ID== "2352", !Collection_ID== "2366", !Collection_ID== "2367", !Collection_ID== "2380", !Collection_ID== "2392"  )
#WM<- WM[-c(1055,419,423, 432),]# Taking out this row that is in blank
WM$long <- as.numeric  (as.character(WM$long))# Transforming long variables to numeric
#WM<- WM[-1293, ]
WM$long <- (WM$long) * -1 # Transforming the long variable to the Hemispher West side


#WM$Collection_ID=="2215"
WM$Year <- as.factor(WM$Year)
# WM$Host <- as.factor(WM$Host)
# WM$State <- as.factor(WM$State)
# WM$County <- as.factor(WM$County)
# WM$Country <- as.factor(WM$Country)
# WM$Field <- as.factor(WM$Field)
# WM$Form.ID <- as.factor(WM$Form.ID)
# WM$Serial_agar_dilution_for_creating_the_model_..N.20. <- as.factor(WM$Serial_agar_dilution_for_creating_the_model_..N.20.)
# #WM$Origin<- as.factor(WM$Origin)
# WM$hyphal_tip..ht. <- as.factor(WM$hyphal_tip..ht.)
# WM$DNA.Extraction <- as.factor(WM$DNA.Extraction)
# WM$Size.of.field..acres. <- as.factor(WM$Size.of.field..acres.)
# WM$Percentage.Affected <- as.factor(WM$Percentage.Affected)
# WM$History <- as.factor(WM$History)
# WM$Number.of.Years <- as.factor(WM$Number.of.Years)
# WM$Fungicide.This.Year <- as.factor(WM$Fungicide.This.Year)
# WM$Chemigation <- as.factor(WM$Chemigation)
# WM$Applied.for.White.Mold <- as.factor(WM$Applied.for.White.Mold)
# WM$Products <- as.factor(WM$Products)
# WM$Timing <- as.factor(WM$Timing)
# WM$Pre.2015.Fungicides <- as.factor(WM$Pre.2015.Fungicides)
# WM$Number.of.Years.1 <- as.factor(WM$Number.of.Years.1)
# WM$Products_Soybean <- as.factor(WM$Products_Soybean)
# WM$Timing..Soybean <- as.factor(WM$Timing..Soybean)
# WM$Notes <- as.factor(WM$Notes)
# WM$Apparently.low.sensitiviy<- as.factor(WM$Apparently.low.sensitiviy)
# 
# Changing the level of year to factor
#the following markas an error that is why it was uncripted  
# The goal is to change  the level of Collection to numeric, but for some reason, it should be by step by step. Changing the level of year to numeric in first approach 
 # WM$Collection_ID <- as.character(WM$Collection_ID)#Changing the level of year to character as second approach
 # levels(WM$Origin )[levels(WM$Origin ) == "trial"] <- "fungicide field trials"#Changing the name to be more specific
  #levels(WM$Origin  )[levels(WM$Origin ) == "Survey"] <- "farmer fields"#Changing the name to be more specific
  levels(WM$DNA.Extraction )[levels(WM$DNA.Extraction ) == ""] <- "No DNA extraction"#Changing the name to be more specific
  levels(WM$DNA.Extraction )[levels(WM$DNA.Extraction ) == "No"] <- "No DNA extraction"#Changing the name to be more specific
  levels(WM$DNA.Extraction )[levels(WM$DNA.Extraction ) == "Yes"] <- "Yes DNA extraction"#Changing the names to be more specific
usa <- map_data("usa")# USA map 
states <- map_data("state")# USA map by states
counties <- map_data("county")# USA map by counties
bra <- map_data("worldHires", "Brazil")
mexico <- map_data("worldHires", "Mexico")

mid_west_county <-
  subset(
    counties,
    region == "nebraska" |
      region == "wisconsin" | region == "michigan" | region == "iowa"
  )

```
Before produce Knit run line 263 twice    
## Backgroundd   
Fungicide applications are essential for maintaining healthy, reliable, and high-quality agricultural products. Resistance to fungicides is an increasing threat to this effectiveness and has already been reported for 203 plant pathogenic fungi (Fungicide Resistance Action Committee 2013). Soybean is the second most important crop in the U.S. and contributes significantly to the nation’s economy with annual sales of $38.7 billion, accounting for 10 percent of total U.S. agriculture sales (Census of Agriculture 2012). In the temperate North Central soybean production areas of the United States, the white mold disease can be a significant yield limiting disease, with reported losses more than 10 million bushels per year (Peltier et al. 2012). This yield loss is significant and makes S. sclerotiorum one of the most important pathogens of soybean in the North Central U.S. In Mexico, dry common bean (_Phaseolus vulgaris_) is the second most important crop and is also significantly affected by _S._ _sclerotiorum_. For example, in the State of Sinaloa, _S._ _sclerotiorum_ causes up to 75% yield loss in dry bean and is considered the most important fungal pathogen (Apodaca et al. 2011).
Lack of adequate levels of host resistance means that fungicides are the primary method of disease control (Bardin and Huang 2001). A major problem is that by the time fungicide resistance is detected by growers, it may be too late to prevent spread of fungicide resistance. Identifying changes in fungicide sensitivity requires knowledge of existing baseline sensitivity to each class of fungicides. Acquisition of fungicide resistance within a completely susceptible population begins with emergence and is followed by selection and adjustment phases. Few studies have addressed the emergence phase and there is a debate about the role of fungicide dose (Van Den Bosch et al. 2011). In the literature, authors speculate that rate of resistance emergence may be directly related to pathogen exposure to low-doses of fungicides (Gressel 2011), which may increase with fewer fungicide applications, such as is recommended in an Integrate Pest Management (IPM) method (Beckerman et al. 2015). This is relevant to soybean production because low-doses of fungicides are likely to occur in the field, whether due to intentional reduction of application rates or unintentionally because of incomplete spray coverage. Other factors related to risk of resistance emergence in fungal plant pathogens is the mechanism of reproduction of the fungus (sexual out-crossing, sexual selfing or asexual reproduction) and population structure of the pathogen. Knowledge of the population structure and spread of _S._ _sclerotiorum_ on soybean and dry bean is needed.  

## THE FIRST PART OF DISSERTATION, Survey fungicide sensitivity of populationss of S. sclerotiorum from soybean
#Backgroundddd
Knowledge of baseline sensitivity of a pathogen population to fungicides is important for detection of resistance and for achieving effective disease management strategies (Brent and Holloman 2007). QoI, DMI, MBC and SDHI fungicides are used to control _S._ _sclerotiorum_ in an IPM approach in soybean and dry bean in the U.S. DMI fungicides are considered to medium risk of resistance emergence, whereas QoI, SDHI and MBC are high risk (Fungicide Resistance Action Committee 2016). MBC and dicarboximide fungicides are used for white mold in Brazil, wherein resistance to MBC fungicide, Thiophanate methyl, has been reported (Lehner et al. 2015). Fungicide resistance has also been reported in China to the MBC, Carbendazim and dicarboximide, Dimethachlon (Ma et al. 2009). Field application of fungicides in the United States on soybean show control of S. sclerotiorum is low to fair for QoI, DMI and MBC fungicides, and good for SDHI fungicides (The North Central Regional Committee on Soybean Diseases 2015). However, it is unknown whether efficacy is related to reduce sensitivity within populations under study. Therefore, the __hypothesis of this objective is that there are isolates of _S. sclerotiorum_ with low sensitivity to the most commonly used fungicides in the North Central United States.__  

__Results will be used to determine whether some isolates are resistant to a given fungicide. It is expected that resistance to fungicides with single-site modes (β -tubulin assembly in mitosis, C14 demethylase in sterol biosynthesis, complex III cytochrome bc1 at Qo site and complex II succinate-dehydro-genase) of action will be more common than for multi-site fungicides__



   
## Objective   
 1. Select hierarchieally isolates by space according 


### Setting some objects previuosly work with
```{r}
#Aready susbsitited the formID of baselines isolates for the Collection_ID  
tested <-# #Fungicide pre-tested isolates from USA midwest including baselines and  Mexican isolates
  c(
    "1",
    "118",
    "123",
    "12B",
    "129",
    "20",
    "21",
    "449",
    "461",
    "467",
    "475",
    "558",
    "564",
    "568",
    "581",
    "645",
    "800",
    "667",
    "74-SS-1",
    "8",
    "87",
    "2390" ,
    "2386",
    "2385",
    "2098",
    "2099",
    "2100",
    "2139",
    "2140",
    "2143",
    "2220",
    "2222",
    "2223",
    "2362",
    "2320",
    "2388",
    "1025",
    "1026",
    "1027",
    "1029",
    "1032",
    "1033",
    "1870",#mexican isolates
    "1872",#mexican isolates
    "1884",#mexican isolates
    "1885",#mexican isolates
    "2453", #54c
    "2528",#65B
    "2449",#53b
    "2505",# 71B
    "2518", #64D
    "2536", #53b
  "2559",  #"60A",
    "698",
    "699",
    "710",
    "711",
    "724",
    "725",
    "731",
    "732",
    "738",
    "739",
    "746",
    "751",
    "755",
    "756",
    "757",
    "764",
    "765",
    "771",
    "772",
    "786",
    "787",
    "811",
    "812",
    "813",
    "814",
    "817",
    "818",
    "851",
    "852",
    "853",
    "855",
    "858",
    "859",
    "860",
    "861",
    "862",
    "867",
    "870",
    "871",
    "877",
    "878",
    "884",
    "885",
    "891",
    "892",
    "896",
    "897",
    "901",
    "902",
    "905",
    "906",
    "908",
    "909",
    "911",
    "912",
    "914",
    "274",
    "307",
    "504",
    "505",
    "2384",
    "2385",
    "2386",
    "2388",
    "2407",
    "2408",
    "2383",
    "1058",
    "1081",
    "1087",
    "1109",
    "1127",
    "1128",
    "1134",
    "1135",
    "1139",
    "1175",
    "1026",
    "1027",
    "1029",
    "1328",
    "1329",
    "1330",
    "1331",
    "1332",
    "1340",
    "1345",
    "1365",
    "1366",
    "1392",
    "1327",
    "1502",
    "1582",
    "1620",
    "1622",
    "1541",
    "1671",
    "1672",
    "1691",
    "1692",
    "1712",
    "1713",
    "1721",
    "1722",
    "1731",
    "1732",
    "1791"
    # "1",  #since here repeated
    #  "118",
    #  "123",
    #  "20",
    #  "74-SS-2",
    #  "8",
    #  "2385",
    #  "2140",
    #  "2220",
    #  "2222"
  )
mexican_isolates <- c("242","248","248a","248b","615":"632", "779","1857":"1940" )#All isolates from Mexico
brazilian_isolates <- c("400","400a","400b","402","972",
"973", 
"973A",
"973B",
"973C",
"973D",
"973E",
"974",
"974A",
"974B",
"974C",
"974D",
"974E",
"975",
"975A",
"975B",
"975C",
"975D",
"975E",
"976",
"976A",
"976B",
"976C",
"976D",
"976E",
"977",
"977A",
"977B",
"977C",
"977D",
"977E",
"978",
"978A", 
"978B", 
"978C",
"978D",
"978E",
"979",
"979A",
"979B",
"979C",
"979D",
"979E", "1010":"1022","1227":"1254","2417":"2569" )#All isolates from Brazil
baseline_isolates <- c("1","118", "123", "12B", "129", "20", "21", "449", "61", "467", "475", "558", "564", "568", "581", "645", "800", "667", "74-SS-1", "8", "87")
white_mold_nursery <- c( "449", "461", "467", "475", "558", "564", "568", "581", "645", "800", "667")

survey_before_fungicides_lunched <- c("1","118", "123", "12B", "129", "20", "21",  "74-SS-1", "8", "87")
 tested[duplicated(tested)]
 tested <- tested[!duplicated(tested)]
 unknown <- c("No_info")
Group_one <- c("thiophanate_methyl")
Group_3 <- c( "prothioconazole", "tetraconazole", "flutriafol", "propiconazole", "tebuconazole")
Group_7 <- c("fluxapyroxad", "boscalid")
Group_11 <- c("picoxystrobin", "azoxystrobin", "fluoxastrobin", "pyraclostrobin", "trifloxystrobin")
Group_M_05 <- c("chlorothalonil")
not_considered_group <- c("potassium phosphite")
Group_3_Group_7 <- c( "flutriafol + fluoxastrobin", "propiconazole + azoxystrobin", "prothioconazole + trifloxystrobin") 
         
 Group_3_Group_11 <-  c("tetraconazole + pyraclostrobin", "propiconazole + azoxystrobin","prothioconazole + trifloxystrobin", "tetraconazole + fluatriafol + fluxastrobin")     
Group_7_Group_11 <- c( "fluxapyroxad + pyraclostrobin", "pyraclostrobin + fluxapyroxad + pyraclostrobin")                       
                     
 Group_3_not_considered_group <- "tebuconazole + potassium phosphite"
 
 Group_11_Group_M_05 <- c("azoxystrobin + chlorothalonil")
 #Baseline_isolates <- c("No_Applied")
```

##White Mold selection from USA midwest  
###Data wrangling

```{r}
# WM2 <- WM %>% select(Collection_ID, Fungicide_current_season, molecule.s._current_season, active.ingredient_current_season, Fungicide_previous_seasons, molecule.s._previous_seasons, active.ingredient_previous_seasons)

# levels(WM2$Fungicide_current_season)[levels(WM2$Fungicide_current_season) == "No_info"] <- "unknown"
# 
# levels(WM2$molecule.s._current_season)[levels(WM2$molecule.s._current_season) == ""] <- "unknown"
# 
# levels(WM2$active.ingredient_current_season)[levels(WM2$active.ingredient_current_season) == ""] <- "unknown"
# 
# levels(WM2$Fungicide_previous_seasons)[levels(WM2$Fungicide_previous_seasons) == ""] <- "unknown"
# 
# levels(WM2$molecule.s._previous_seasons)[levels(WM2$molecule.s._previous_seasons) == ""] <- "unknown"
# 
# levels(WM2$active.ingredient_previous_seasons)[levels(WM2$active.ingredient_previous_seasons) == ""] <- "unknown"


# Group_1 <- c("thiophanate_methyl")
# Group_3 <- c("thiophanate_methyl", "prothioconazole", "tetraconazole", "flutriafol", "propiconazole", "tebuconazole")
# Group_7 <- c("fluxapyroxad", "boscalid")
# Group_11 <- c("picoxystrobin", "azoxystrobin", "fluoxastrobin", "pyraclostrobin", "trifloxystrobin")
# Group_M_05 <- c("chlorothalonil")
# not_considered_group <- c("potassium phosphite")


# WM3 <- WM2 %>% select(Collection_ID, active.ingredient_current_season, active.ingredient_previous_seasons)
# selection <- WM3  %>%
#   mutate(
#     Group_MOA_current_season = case_when(
#       active.ingredient_current_season %in% Group_1 ~ "Group_1",# filtering and naming "selected"" in case of in
#       active.ingredient_current_season %in% Group_3~ "Group_3",
#       active.ingredient_current_season %in% Group_7 ~ "Group_7",
#       active.ingredient_current_season %in% Group_11 ~ "Group_11",
#       active.ingredient_current_season %in% Group_M_05 ~ "Group_M_05",
#       active.ingredient_current_season %in% not_considered_group~ "not_considered_group",
  #     TRUE ~ "unknown"# in case of not, naming "not_selected""
  #   )
  # )   %>%
  # mutate(
  #   Group_MOA_previous_seasons = case_when(
  #     active.ingredient_previous_seasons %in% Group_1 ~ "Group_1",# filtering and naming "selected"" in case of in
  #     active.ingredient_previous_seasons %in% Group_3~ "Group_3",
  #     active.ingredient_previous_seasons %in% Group_7 ~ "Group_7",
  #     active.ingredient_previous_seasons %in% Group_11 ~ "Group_11",
  #     active.ingredient_previous_seasons %in% Group_M_05 ~ "Group_M_05",
  #     active.ingredient_previous_seasons %in% not_considered_group~ "not_considered_group",
  #     TRUE ~ "unknown"# in case of not, naming "not_selected""
  #   )
  # )  
```


```{r `}
  wm1 <-
  WM %>% select(
    Collection_ID,
    Host, 
    State,
    Field,
    Year,
    Origin,
    long,
    lat,
    hyphal_tip..ht.,
    DNA.Extraction,
    County,
    Country,
    Serial_agar_dilution_for_creating_the_model_..N.20.,
    Form.ID, Fungicide_current_season, molecule.s._current_season,  Fungicide_previous_seasons, molecule.s._previous_seasons#, active.ingredient_previous_seasons
      )# Selecting  the most important columns so far

wm1_ <-  wm1 %>%
  mutate(Fungicide_status = ifelse(Collection_ID  %in% tested,
                                   "tested", "no_tested")) #%>% Creating a new column based wheather or not funcides pretested
 # filter(!Collection_ID %in% mexican_isolates) %>%#Taking out mexican isolates
#   group_by(Field) %>% mutate (num_isolates_per_field = ifelse(n() > 9, ">9isolates/Field", "<9isolates/Field")) %>%
#   #Creating a new column if the number of isolates/field is major than 2
#   ungroup()
#   
# wm1_$num_isolates_per_field <- as.factor(wm1_$num_isolates_per_field)#Converting as factor the levels of the new columns

levels(wm1_$Origin) = c("" ,  "farmer fields", "fungicide field trials", "baseline isolates")

levels(wm1_$Origin )[levels(wm1_$Origin ) == "trial"] <- "fungicide field trials"#Changing the name to be more specific
  levels(wm1_$Origin  )[levels(wm1_$Origin ) == "Survey"] <- "farmer fields"#Changing the name to be more specific

  wm1_[(which(wm1_$Collection_ID %in% baseline_isolates)), 6] <- "baseline isolates"

#wm1_$Collection_ID[which(wm1_$Collection_ID %in% baseline_isolates)] <- "baseline isolates"

  wm1_$Origin<- as.factor(wm1_$Origin)
  
#levels(wm1_$Origin) = c("" ,  "farmer fields", "fungicide field trials", "baseline isolates") #, "White_mold_nursery", "Survey before fungicides lunched"  )#, "farmer fields before fungicides lunched")


#wm1_[(which(wm1_$Collection_ID %in% white_mold_nursery)), 6] <- "White_mold_nursery"

#wm1_[(which(wm1_$Collection_ID %in% survey_before_fungicides_lunched)), 6] <- "Survey before fungicides lunched"

#wm1_[(which(wm1_$Collection_ID %in% survey_before_fungicides_lunched)), 6] <- "before fungicides lunched"

levels(wm1_$Fungicide_current_season)[levels(wm1_$Fungicide_current_season) == "No_info"] <- "unknown"

levels(wm1_$molecule.s._current_season)[levels(wm1_$molecule.s._current_season) == ""] <- "unknown"

#levels(wm1_$active.ingredient_current_season)[levels(wm1_$active.ingredient_current_season) == ""] <- "unknown"

levels(wm1_$Fungicide_previous_seasons)[levels(wm1_$Fungicide_previous_seasons) == ""] <- "unknown"

levels(wm1_$molecule.s._previous_seasons)[levels(wm1_$molecule.s._previous_seasons) == ""] <- "unknown"

#levels(wm1_$active.ingredient_previous_seasons)[levels(wm1_$active.ingredient_previous_seasons) == ""] <- "unknown"
  
# Group_1 <- c("thiophanate_methyl")
# Group_3 <- c("thiophanate_methyl", "prothioconazole", "tetraconazole", "flutriafol", "propiconazole", "tebuconazole")
# Group_7 <- c("fluxapyroxad", "boscalid")
# Group_11 <- c("picoxystrobin", "azoxystrobin", "fluoxastrobin", "pyraclostrobin", "trifloxystrobin")
# Group_M_05 <- c("chlorothalonil")
# not_considered_group <- c("potassium phosphite")

wm1_ <- wm1_  %>%
  mutate(
    Group_MOA_current_season = case_when(
       molecule.s._current_season%in% Group_one ~ "Group_one",# filtering and naming "the name of the group" in case of in
       molecule.s._current_season%in% Group_3~ "Group_3",
       molecule.s._current_season%in% Group_7 ~ "Group_7",
       molecule.s._current_season%in% Group_11 ~ "Group_11",
       molecule.s._current_season%in% Group_M_05 ~ "Group_M_05",
       molecule.s._current_season%in% Group_3_Group_7~ "Group_3&Group_7",
       molecule.s._current_season%in% Group_3_Group_11~ "Group_3&Group_11",
       molecule.s._current_season%in% Group_7_Group_11~ "Group_7&Group_11",
       molecule.s._current_season%in% Group_3_not_considered_group~ "Group_3&not_considered_group",
       molecule.s._current_season%in% Group_11_Group_M_05~ "Group_11&Group_M_05",
       molecule.s._current_season%in% unknown~ "unknown",
             TRUE ~ "unknown"# in case of not, naming "not_selected""
    )
  )   %>%
  mutate(
    Group_MOA_previous_seasons = case_when(
       molecule.s._previous_seasons%in% Group_one ~ "Group_one",# filtering and naming "the name of the group" in case of in
       molecule.s._previous_seasons%in% Group_3~ "Group_3",
       molecule.s._previous_seasons%in% Group_7 ~ "Group_7",
       molecule.s._previous_seasons%in% Group_11 ~ "Group_11",
       molecule.s._previous_seasons%in% Group_M_05 ~ "Group_M_05",
       molecule.s._previous_seasons%in% Group_3_Group_7~ "Group_3&Group_7",
       molecule.s._previous_seasons%in% Group_3_Group_11~ "Group_3&Group_11",
       molecule.s._previous_seasons%in% Group_7_Group_11~ "Group_7&Group_11",
       molecule.s._previous_seasons%in% Group_3_not_considered_group~ "Group_3&not_considered_group",
       molecule.s._previous_seasons%in% Group_11_Group_M_05~ "Group_11&Group_M_05",
       molecule.s._previous_seasons%in% unknown~ "unknown",
  

      TRUE ~ "unknown"# in case of not, naming "not_selected""
    )
  )   
            
            

wm1_$Group_MOA_current_season <- as.factor(wm1_$Group_MOA_current_season)
wm1_$Group_MOA_previous_seasons <- as.factor(wm1_$Group_MOA_previous_seasons)

drybeans_tested <- wm1_%>% select(Collection_ID, State, County, Country, Origin, Year, Fungicide_status, Host, Group_MOA_current_season, Group_MOA_previous_seasons) %>% filter(Fungicide_status == "tested", Host== "drybeans") #%>% group_by(Host, State, Origin,Year, Group_MOA_current_season,  Group_MOA_previous_seasons) 
  
  levels(drybeans_tested$Group_MOA_current_season)
  levels(drybeans_tested$Group_MOA_previous_seasons)
#rm(drybeans_tested)
   





levels(drybeans_tested$Group_MOA_current_season) = c("Group_11" , "Group_11&Group_M_05", "Group_3", "Group_3&Group_11", "Group_3&Group_7", "Group_3&not_considered_group", "Group_7", "Group_7&Group_11","Group_one", "unknown", "no fungicide" )

levels(drybeans_tested$Group_MOA_previous_seasons) = c("Group_11" ,  "Group_3", "Group_3&Group_11",  "Group_3&Group_7", "Group_7&Group_11", "Group_one", "unknown", "no fungicide")

drybeans_tested$Group_MOA_current_season[drybeans_tested$Origin%in% c("baseline isolates")] <- "no fungicide"
drybeans_tested$Group_MOA_previous_seasons[drybeans_tested$Origin%in% c("baseline isolates")] <- "no fungicide"






drybeans_tested2 <- drybeans_tested%>% group_by( State,Country,  Origin,  Group_MOA_current_season,  Group_MOA_previous_seasons) %>%  summarize(N_isolates=n()) %>% arrange(desc(N_isolates)) kable() %>%  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "center") 

drybeans_tested2<- drybeans_tested%>% group_by( State,Country,  Origin,  Group_MOA_current_season,  Group_MOA_previous_seasons) %>%  summarize(N_isolates=n())%>% arrange(desc(N_isolates)) %>%ungroup() %>% add_row(State = "Total", N_isolates = sum(.$N_isolates)) %>% rename( "N isolates" = N_isolates, "MOA current season" = Group_MOA_current_season,  "MOA previous seasons" =Group_MOA_previous_seasons)%>% kable(format = "markdown") %>%  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "center") %>%  write2pdf("hi4.pdf")# quiet = TRUE)



drybeans_tested2<- drybeans_tested%>% group_by( State,Country,  Origin,  Group_MOA_current_season,  Group_MOA_previous_seasons) %>%  summarize(N_isolates=n())%>% arrange(desc(N_isolates)) %>%ungroup() %>% add_row(State = "Total", N_isolates = sum(.$N_isolates)) %>% rename( "N isolates" = N_isolates, "MOA current season" = Group_MOA_current_season,  "MOA previous seasons" =Group_MOA_previous_seasons)%>% kable(format = "markdown") %>%  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "center") %>%  write2pdf("hi4.pdf")# quiet = TRUE)



#####################
soybeans_tested <- wm1_%>% select(Collection_ID, State, County, Country, Origin, Year, Fungicide_status, Host, Group_MOA_current_season, Group_MOA_previous_seasons) %>% filter(Fungicide_status == "tested", Host== "soybeans") #%>% group_by(Host, State, Origin,Year, Group_MOA_current_season,  Group_MOA_previous_seasons) 
  
  levels(soybeans_tested$Group_MOA_current_season)
  levels(soybeans_tested$Group_MOA_previous_seasons)
#rm(soybeans_tested)
   





levels(soybeans_tested$Group_MOA_current_season) = c("Group_11" , "Group_11&Group_M_05", "Group_3", "Group_3&Group_11", "Group_3&Group_7", "Group_3&not_considered_group", "Group_7", "Group_7&Group_11","Group_one", "unknown", "no fungicide" )

levels(soybeans_tested$Group_MOA_previous_seasons) = c("Group_11" ,  "Group_3", "Group_3&Group_11",  "Group_3&Group_7", "Group_7&Group_11", "Group_one", "unknown", "no fungicide")

soybeans_tested$Group_MOA_current_season[soybeans_tested$Origin%in% c("baseline isolates")] <- "no fungicide"
soybeans_tested$Group_MOA_previous_seasons[soybeans_tested$Origin%in% c("baseline isolates")] <- "no fungicide"



soybeans_tested2<- soybeans_tested%>% group_by( State,Country,  Origin,  Group_MOA_current_season,  Group_MOA_previous_seasons) %>%  summarize(N_isolates=n())%>% arrange(desc(N_isolates)) %>%ungroup() %>% add_row(State = "Total", N_isolates = sum(.$N_isolates)) %>% rename( "N isolates" = N_isolates, "MOA current season" = Group_MOA_current_season,  "MOA previous seasons" =Group_MOA_previous_seasons)%>% kable(format = "markdown") %>%  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "center") %>%  write2pdf("hi7.pdf")# quiet = TRUE)



drybeans_tested2
#write2pdf(drybeans_tested2,"drybeans_testedTT.pdf")
#%>% 
 #write2pdf("drybeans_testedT.pdf")# quiet = TRUE)
#write_csv(drybeans_tested, "drybeans_table.csv")

# write2pdf(drybeans_tested, "drybeans_testedT.pdf", quiet = TRUE)
# pdf("drybeans_tested.pdf", 7 , 5)
# drybeans_tested
# dev.off()
#q <- drybeans_tested %>%  group_by(State) %>% summarize(n=n())

 
```


